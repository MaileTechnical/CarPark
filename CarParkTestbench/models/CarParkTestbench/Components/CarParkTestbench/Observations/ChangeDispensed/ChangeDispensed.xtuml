-- BP 7.1.6 content: ModelClass syschar: 3 persistence-version: 7.1.6

INSERT INTO O_OBJ
	VALUES ("800b6f71-0938-4149-995e-f73cb2aed1ad",
	'ChangeDispensed',
	29,
	'ChangeDispensed',
	'An observation which checks the outstanding balance at a pay stand and makes payment.
The observation succeeds when the balance is paid in full.',
	"00000000-0000-0000-0000-000000000000");
INSERT INTO O_TFR
	VALUES ("79c190f8-235a-47ff-99a6-bf4f76a19ecd",
	"800b6f71-0938-4149-995e-f73cb2aed1ad",
	'Create',
	'Add an observation of this type to the ''script'' of a test case.
See Observation.AppendPolling for description.',
	"ba5eda7a-def5-0000-0000-000000000000",
	0,
	'create object instance cd of ChangeDispensed;

create object instance observation of Observation;
relate cd to observation across R400;
cd.location = param.location;

observation.AddTriggered( seqLabel:param.seqLabel, timeLimit:0, key:"Dispensed", concurrent:True );

Observation::CancelableBy( Canceler:param.dependee, Cancelee: observation.observationId );',
	1,
	'',
	"00000000-0000-0000-0000-000000000000",
	0);
INSERT INTO O_TPARM
	VALUES ("990ba85d-10ab-48f4-b1b6-75540c930bb3",
	"79c190f8-235a-47ff-99a6-bf4f76a19ecd",
	'location',
	"ba5eda7a-def5-0000-0000-000000000004",
	0,
	'',
	"128e9155-0c79-4771-8803-d30194c65e82",
	'');
INSERT INTO O_TPARM
	VALUES ("128e9155-0c79-4771-8803-d30194c65e82",
	"79c190f8-235a-47ff-99a6-bf4f76a19ecd",
	'seqLabel',
	"ba5eda7a-def5-0000-0000-000000000004",
	0,
	'',
	"00000000-0000-0000-0000-000000000000",
	'');
INSERT INTO O_TPARM
	VALUES ("948fb2fe-a7a5-4cf0-ba23-90ee0dab1339",
	"79c190f8-235a-47ff-99a6-bf4f76a19ecd",
	'dependee',
	"ba5eda7a-def5-0000-0000-000000000005",
	0,
	'',
	"990ba85d-10ab-48f4-b1b6-75540c930bb3",
	'');
INSERT INTO O_TFR
	VALUES ("ea5f2a26-55c7-4b34-b66c-8715aa3e9ded",
	"800b6f71-0938-4149-995e-f73cb2aed1ad",
	'CheckDispensed',
	'When invoked, search any existing notifications looking for a match.',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'// Look for a change/refund amount being dispensed at the appropriate pay station location.

select one observation related by self->Observation[R400]; 
select any tracker from instances of VisitTracking
 where ( selected.payingAt == self.location );

if ( not_empty tracker )
  if ( tracker.amountDispensed > 0 )
    LOG::LogInfo( message:" --- Money dispensed at " + self.location  );
    tracker.changeStatus = ChangeStatus::dispensed;
  end if;
  observation.Complete( success:True );
else
  observation.Complete( success:False );
end if;
',
	1,
	'',
	"79c190f8-235a-47ff-99a6-bf4f76a19ecd",
	0);
INSERT INTO O_NBATTR
	VALUES ("3b95bde8-1e5b-4a1f-b7cd-3adf3588b55c",
	"800b6f71-0938-4149-995e-f73cb2aed1ad");
INSERT INTO O_BATTR
	VALUES ("3b95bde8-1e5b-4a1f-b7cd-3adf3588b55c",
	"800b6f71-0938-4149-995e-f73cb2aed1ad");
INSERT INTO O_ATTR
	VALUES ("3b95bde8-1e5b-4a1f-b7cd-3adf3588b55c",
	"800b6f71-0938-4149-995e-f73cb2aed1ad",
	"00000000-0000-0000-0000-000000000000",
	'location',
	'',
	'',
	'location',
	0,
	"ba5eda7a-def5-0000-0000-000000000004",
	'',
	'');
INSERT INTO O_ID
	VALUES (0,
	"800b6f71-0938-4149-995e-f73cb2aed1ad");
INSERT INTO O_ID
	VALUES (1,
	"800b6f71-0938-4149-995e-f73cb2aed1ad");
INSERT INTO O_ID
	VALUES (2,
	"800b6f71-0938-4149-995e-f73cb2aed1ad");
INSERT INTO PE_PE
	VALUES ("800b6f71-0938-4149-995e-f73cb2aed1ad",
	1,
	"8d0b291c-e8aa-44d2-8917-c259479b29a2",
	"00000000-0000-0000-0000-000000000000",
	4);
INSERT INTO EP_PKG_PROXY
	VALUES ("8d0b291c-e8aa-44d2-8917-c259479b29a2",
	"00000000-0000-0000-0000-000000000000",
	"87ff681e-390e-45ca-9f9c-e0259790ea6c",
	'Observations',
	'',
	0,
	'../Observations.xtuml');
